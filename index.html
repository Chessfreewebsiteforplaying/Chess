<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bàn Cờ Vua</title>
    <style>
        body { font-family: Arial, sans-serif; }
        h1 { text-align: center; }
        .chess-board { 
            display: grid; 
            grid-template-columns: repeat(8, 50px); 
            width: 400px; 
            margin: auto; 
            border: 2px solid black;
        }
        .chess-board div { 
            width: 50px; 
            height: 50px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 32px; 
        }
        .black { background-color: #666; color: white; }
        .white { background-color: #fff; color: black; }
        .piece { cursor: pointer; user-select: none; }
    </style>
</head>
<body>
    <h1>Bàn Cờ Vua</h1>
    <div class="chess-board" id="chess-board">
        <!-- Các quân cờ sẽ được tạo bằng JavaScript -->
    </div>

    <script>
        const board = document.getElementById('chess-board');

        // Tạo bàn cờ 8x8 và đặt quân cờ ban đầu
        const initialBoard = [
            ["♖", "♘", "♗", "♕", "♔", "♗", "♘", "♖"],
            ["♙", "♙", "♙", "♙", "♙", "♙", "♙", "♙"],
            ...Array(4).fill(Array(8).fill("")),
            ["♙", "♙", "♙", "♙", "♙", "♙", "♙", "♙"],
            ["♖", "♘", "♗", "♕", "♔", "♗", "♘", "♖"]
        ];

        function createChessBoard() {
            board.innerHTML = '';
            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 8; j++) {
                    const cell = document.createElement('div');
                    cell.className = (i + j) % 2 === 0 ? 'white' : 'black';
                    const piece = document.createElement('span');
                    piece.className = 'piece';
                    piece.textContent = initialBoard[i][j] || '';

                    if (piece.textContent) {
                        piece.setAttribute('draggable', true);
                    }

                    // Di chuyển quân cờ trên cả máy tính và điện thoại
                    piece.addEventListener('dragstart', handleDragStart);
                    piece.addEventListener('touchstart', handleTouchStart);
                    piece.addEventListener('touchmove', handleTouchMove);
                    piece.addEventListener('touchend', handleTouchEnd);

                    cell.addEventListener('dragover', handleDragOver);
                    cell.addEventListener('drop', handleDrop);

                    cell.appendChild(piece);
                    board.appendChild(cell);
                }
            }
        }

        // Xử lý kéo-thả trên máy tính
        let draggedPiece = null;

        function handleDragStart(e) {
            draggedPiece = e.target;
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            if (draggedPiece && e.target.classList.contains('piece') && !e.target.textContent) {
                e.target.textContent = draggedPiece.textContent;
                draggedPiece.textContent = '';
                draggedPiece = null;
            }
        }

        // Xử lý kéo-thả trên thiết bị di động
        function handleTouchStart(e) {
            draggedPiece = e.target;
        }

        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const piece = document.elementFromPoint(touch.clientX, touch.clientY);

            if (piece && piece.classList.contains('piece') && !piece.textContent) {
                piece.style.background = '#ccc'; // Hiệu ứng tạm thời
            }
        }

        function handleTouchEnd(e) {
            const touch = e.changedTouches[0];
            const target = document.elementFromPoint(touch.clientX, touch.clientY);

            if (draggedPiece && target && target.classList.contains('piece') && !target.textContent) {
                target.textContent = draggedPiece.textContent;
                draggedPiece.textContent = '';
            }
            draggedPiece = null;
        }

        createChessBoard();
    </script>
</body>
</html>
